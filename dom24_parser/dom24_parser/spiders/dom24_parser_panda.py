import scrapy
import html

product_id = 0
description = '<ul type="disc" style="margin-bottom: 0cm; font-size: medium;"><li class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 11.5pt; font-family: Arial, sans-serif;">Длина панели: 2700 мм;<o:p></o:p></span></li><li class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 11.5pt; font-family: Arial, sans-serif;">Ширина панели: 250 мм;<o:p></o:p></span></li><li class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 11.5pt; font-family: Arial, sans-serif;">Толщина</span><span lang="EN-US" style="font-size: 11.5pt; font-family: Arial, sans-serif;">: 8</span><span style="font-size: 11.5pt; font-family: Arial, sans-serif;">мм<o:p></o:p></span></li><li class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 11.5pt; font-family: Arial, sans-serif;">Полезная площадь: 0,675 м</span><sup style="font-size: 11px;"><span style="font-size: 8.5pt; font-family: Arial, sans-serif;">2</span></sup><span style="font-size: 11.5pt; font-family: Arial, sans-serif;"><o:p></o:p></span></li><li class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 11.5pt; font-family: Arial, sans-serif;">Вес панели: 1,16 кг;<o:p></o:p></span></li><li class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 11.5pt; font-family: Arial, sans-serif;">Количество в коробке: 10 шт;<o:p></o:p></span></li><li class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 11.5pt; font-family: Arial, sans-serif;">Объем коробки: 0,06 м</span><sup style="font-size: 11px;"><span style="font-size: 8.5pt; font-family: Arial, sans-serif;">3</span></sup><span style="font-size: 11.5pt; font-family: Arial, sans-serif;">.</span></li><li class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 11.5pt; font-family: Arial, sans-serif;"><br></span></li></ul><p class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><b><span style="font-size: 8.5pt; font-family: Tahoma, sans-serif; color: rgb(62, 63, 63);">Стеновые пластиковые панели</span></b><span style="font-size: 8.5pt; font-family: Tahoma, sans-serif; color: rgb(62, 63, 63);">&nbsp;имеют очень большой срок службы, обладают стопроцентную устойчивость к влаги и даже в стыках не пропускают влагу. Пластиковые панели устойчивы к влиянию атмосферных явлений и могут выдерживать сильные механические нагрузки.<o:p></o:p></span></p><ul type="disc" style="margin-bottom: 0cm; font-size: medium;"><li class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(62, 63, 63); text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 8.5pt; font-family: Tahoma, sans-serif;">С помощью такого отделочного материала, как стеновые панели ПВХ, можно сделать быстрый, чистый и качественный ремонт;<o:p></o:p></span></li><li class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(62, 63, 63); text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 8.5pt; font-family: Tahoma, sans-serif;">Декоративные рейки плюс гладкие вторые стены помогают помещению обрести современный вид;<o:p></o:p></span></li><li class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(62, 63, 63); text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 8.5pt; font-family: Tahoma, sans-serif;">Пластиковые панели можно установить на разнообразные поверхности;<o:p></o:p></span></li><li class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(62, 63, 63); text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 8.5pt; font-family: Tahoma, sans-serif;">Панели ПВХ легко скроют неровности стен;&nbsp;<o:p></o:p></span></li><li class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(62, 63, 63); text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 8.5pt; font-family: Tahoma, sans-serif;">Электропроводка прячется за панели ПВХ;<o:p></o:p></span></li><li class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(62, 63, 63); text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 8.5pt; font-family: Tahoma, sans-serif;">Звукоизоляция улучшается;<o:p></o:p></span></li><li class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(62, 63, 63); text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 8.5pt; font-family: Tahoma, sans-serif;">Не подвергаются воздействию низких температур и могут устанавливаться в помещениях без отопления;<o:p></o:p></span></li><li class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(62, 63, 63); text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 8.5pt; font-family: Tahoma, sans-serif;">Степень пожаробезопасности высокая, горение не поддерживается;<o:p></o:p></span></li><li class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: rgb(62, 63, 63); text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 8.5pt; font-family: Tahoma, sans-serif;">Пластиковые панели – это экологически безопасные материалы для отделки.<o:p></o:p></span></li></ul><p class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 8.5pt; font-family: Tahoma, sans-serif; color: rgb(62, 63, 63);">Пластиковые панели не требуют значительного ухода. Их можно использовать для отделки любых бытовых помещений: ванные комнаты, душевые, кухни, туалеты и т.п. т.к. стеновые пластиковые панели соответствуют всем гигиеническим требованиям. Чтобы поддерживать пластиковые панели в чистоте, достаточно всего лишь иногда протирать их влажной тряпкой или любым доступным моющим средством, которое не содержит абразивные элементы.<o:p></o:p></span></p><p class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 8.5pt; font-family: Tahoma, sans-serif; color: rgb(62, 63, 63);">Практически полное отсутствие отходов, пыли и грязи при отделке пластиковыми панелями также является неоспоримым достоинством.<o:p></o:p></span></p><p class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><b><span style="font-size: 9pt; font-family: Tahoma, sans-serif; color: rgb(12, 153, 193);">Особенности конструкции<o:p></o:p></span></b></p><p class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 8.5pt; font-family: Tahoma, sans-serif; color: rgb(62, 63, 63);">Ребра жесткости обеспечивают высокую прочность панелей, благодаря своей конструкции.<o:p></o:p></span></p><p class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 8.5pt; font-family: Tahoma, sans-serif; color: rgb(62, 63, 63);">Любая декоративная пластиковая панель имеет определенное количество изолированных ячеек, и, благодаря этому пластиковые панели имеют высокие термо- и звукоизолирующие характеристики.</span></p><p class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><img src="https://dom24.ee/image/catalog/ в разрезе.jpg" style="width: 432px;"><span style="font-size: 8.5pt; font-family: Tahoma, sans-serif; color: rgb(62, 63, 63);"><br></span></p><p class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><b><span style="font-size: 9pt; font-family: Tahoma, sans-serif; color: rgb(12, 153, 193);">Область применения<o:p></o:p></span></b></p><p class="MsoNormal" style="margin: 0cm 0cm 8pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; text-align: justify; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 8.5pt; font-family: Tahoma, sans-serif; color: rgb(62, 63, 63);">Пластиковые панели устанавливают на стены и потолки во влажных помещениях (санузлы, бассейны, душевые), так как панели не боятся влаги; на лоджиях, балконах, так как пластиковые панели морозоустойчивые; в жилых помещениях, так как панели пвх экологичны;&nbsp;на кухне и в&nbsp;подсобных помещениях, так как панели ПВХ легко моются.</span></p>'

# description_escape = cgi.escape(description, True)
description_escape = html.escape(description, True)


class Dom24ScraperPanda(scrapy.Spider):
    name = 'dom24_panda'
    start_urls = ['https://www.panda-panel.ru/catalog/kukhonnye_fartuki/']

    def parse (self, response):
        products = response.css('div.item.product')
        for product in products:
            product_link = product.css('div.productColText a.name::attr(href)').get()
            yield response.follow(product_link, self.parse_product)

    #     проверяем на наличие пагинации на странице товаров в категории
        next_page = response.css('li.bx-pag-next a::attr(href)').get()
        if next_page is not None:
            yield response.follow(next_page, self.parse)

    def parse_product (self, response):
        global product_id
        global description
        product_id += 1
        images = []
        images_links = response.css('div.slides a::attr(href)').getall()
        for image_link in images_links:
            images.append('https:' + image_link.strip())
        yield {
            'product_id': product_id,
            'Category': category_name,
            'Name': response.css('h1#pagetitle::text').get().strip(),
            'Title': response.css('h1#pagetitle::text').get().strip(),
            'Image': images,
            'Price': response.css('div.middle_info span.price_value::text').get().strip(),
            'Model': response.css('h1#pagetitle::text').get().strip(),
            # 'Description': cgi.escape(description, True)
            'Description': description_escape
        }
